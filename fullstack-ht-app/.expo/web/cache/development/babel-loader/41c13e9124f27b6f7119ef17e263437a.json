{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport firebase from \"firebase/app\";\nimport \"firebase/auth\";\nimport \"firebase/firestore\";\nexport var sendChatMessage = function sendChatMessage(chatID, text, otherUserUid) {\n  firebase.firestore().collection('messages').doc(chatID).collection('chats').add({\n    text: text,\n    createdAt: new Date().getTime(),\n    user: {\n      _id: firebase.auth().currentUser.uid\n    }\n  });\n  firebase.firestore().collection('messages').add({\n    text: text,\n    createdAt: new Date().getTime(),\n    sendFrom: firebase.auth().currentUser.uid,\n    sendTo: otherUserUid\n  });\n};\nexport var getMyMessages = function getMyMessages() {\n  var messagesRef, currentUser, sendFrom, sendTo, sendFromQuerySnapshot, sendToQuerySnapshot, sendFromArray, sendToArray, myMessagesArray;\n  return _regeneratorRuntime.async(function getMyMessages$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          messagesRef = firebase.firestore().collection('messages');\n          currentUser = firebase.auth().currentUser;\n          _context.next = 4;\n          return _regeneratorRuntime.awrap(messagesRef.where('sendFrom', '==', currentUser.uid).get());\n\n        case 4:\n          sendFrom = _context.sent;\n          _context.next = 7;\n          return _regeneratorRuntime.awrap(messagesRef.where('sendTo', '==', currentUser.uid).get());\n\n        case 7:\n          sendTo = _context.sent;\n          sendFromQuerySnapshot = sendFrom, sendToQuerySnapshot = sendTo;\n          sendFromArray = sendFromQuerySnapshot.docs;\n          sendToArray = sendToQuerySnapshot.docs;\n          console.log(sendFromArray);\n          console.log(sendToArray);\n          myMessagesArray = sendFromArray.concat(sendToArray);\n          return _context.abrupt(\"return\", myMessagesArray);\n\n        case 15:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, null, null, null, Promise);\n};","map":{"version":3,"sources":["/home/hejoel/fullstack/fullstack-ht/fullstack-ht/fullstack-ht-app/src/firebase/chat.js"],"names":["firebase","sendChatMessage","chatID","text","otherUserUid","firestore","collection","doc","add","createdAt","Date","getTime","user","_id","auth","currentUser","uid","sendFrom","sendTo","getMyMessages","messagesRef","where","get","sendFromQuerySnapshot","sendToQuerySnapshot","sendFromArray","docs","sendToArray","console","log","myMessagesArray","concat"],"mappings":";AACA,OAAOA,QAAP,MAAqB,cAArB;AACA,OAAO,eAAP;AACA,OAAO,oBAAP;AAGA,OAAO,IAAMC,eAAe,GAAG,SAAlBA,eAAkB,CAACC,MAAD,EAASC,IAAT,EAAeC,YAAf,EAAgC;AAE7DJ,EAAAA,QAAQ,CAACK,SAAT,GACGC,UADH,CACc,UADd,EAEGC,GAFH,CAEOL,MAFP,EAGGI,UAHH,CAGc,OAHd,EAIGE,GAJH,CAIO;AACHL,IAAAA,IAAI,EAAEA,IADH;AAEHM,IAAAA,SAAS,EAAE,IAAIC,IAAJ,GAAWC,OAAX,EAFR;AAGHC,IAAAA,IAAI,EAAE;AACJC,MAAAA,GAAG,EAAEb,QAAQ,CAACc,IAAT,GAAgBC,WAAhB,CAA4BC;AAD7B;AAHH,GAJP;AAYEhB,EAAAA,QAAQ,CAACK,SAAT,GACCC,UADD,CACY,UADZ,EAECE,GAFD,CAEK;AACHL,IAAAA,IAAI,EAAEA,IADH;AAEHM,IAAAA,SAAS,EAAE,IAAIC,IAAJ,GAAWC,OAAX,EAFR;AAGHM,IAAAA,QAAQ,EAAEjB,QAAQ,CAACc,IAAT,GAAgBC,WAAhB,CAA4BC,GAHnC;AAIHE,IAAAA,MAAM,EAAEd;AAJL,GAFL;AAQH,CAtBM;AA0BP,OAAO,IAAMe,aAAa,GAAG,SAAhBA,aAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAErBC,UAAAA,WAFqB,GAEPpB,QAAQ,CAACK,SAAT,GAAqBC,UAArB,CAAgC,UAAhC,CAFO;AAGrBS,UAAAA,WAHqB,GAGPf,QAAQ,CAACc,IAAT,GAAgBC,WAHT;AAAA;AAAA,2CAMJK,WAAW,CAACC,KAAZ,CAAkB,UAAlB,EAA8B,IAA9B,EAAoCN,WAAW,CAACC,GAAhD,EAAqDM,GAArD,EANI;;AAAA;AAMrBL,UAAAA,QANqB;AAAA;AAAA,2CAONG,WAAW,CAACC,KAAZ,CAAkB,QAAlB,EAA4B,IAA5B,EAAkCN,WAAW,CAACC,GAA9C,EAAmDM,GAAnD,EAPM;;AAAA;AAOrBJ,UAAAA,MAPqB;AASpBK,UAAAA,qBAToB,GAUzBN,QAVyB,EASGO,mBATH,GAWzBN,MAXyB;AAcrBO,UAAAA,aAdqB,GAcLF,qBAAqB,CAACG,IAdjB;AAerBC,UAAAA,WAfqB,GAePH,mBAAmB,CAACE,IAfb;AAiB3BE,UAAAA,OAAO,CAACC,GAAR,CAAYJ,aAAZ;AACAG,UAAAA,OAAO,CAACC,GAAR,CAAYF,WAAZ;AAEMG,UAAAA,eApBqB,GAoBHL,aAAa,CAACM,MAAd,CAAqBJ,WAArB,CApBG;AAAA,2CAsBpBG,eAtBoB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAtB","sourcesContent":["// import * as firebase from 'firebase';\nimport firebase from \"firebase/app\";\nimport \"firebase/auth\";\nimport \"firebase/firestore\";\n\n\nexport const sendChatMessage = (chatID, text, otherUserUid) => {\n\n  firebase.firestore()\n    .collection('messages')\n    .doc(chatID)\n    .collection('chats')\n    .add({\n      text: text,\n      createdAt: new Date().getTime(),\n      user: {\n        _id: firebase.auth().currentUser.uid\n      }\n    });\n\n    firebase.firestore()\n    .collection('messages')\n    .add({\n      text: text,\n      createdAt: new Date().getTime(),\n      sendFrom: firebase.auth().currentUser.uid,\n      sendTo: otherUserUid\n    });    \n};\n\n\n\nexport const getMyMessages = async () => {\n\n  const messagesRef = firebase.firestore().collection('messages');\n  const currentUser = firebase.auth().currentUser;\n\n\n  const sendFrom = await messagesRef.where('sendFrom', '==', currentUser.uid).get();\n  const sendTo = await messagesRef.where('sendTo', '==', currentUser.uid).get();\n\n  const [sendFromQuerySnapshot, sendToQuerySnapshot] = [\n    sendFrom,\n    sendTo\n  ];\n\n  const sendFromArray = sendFromQuerySnapshot.docs;\n  const sendToArray = sendToQuerySnapshot.docs;\n\n  console.log(sendFromArray);\n  console.log(sendToArray);\n\n  const myMessagesArray = sendFromArray.concat(sendToArray);\n\n  return myMessagesArray;\n};\n"]},"metadata":{},"sourceType":"module"}